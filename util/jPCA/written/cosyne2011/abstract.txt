To be clinically useful, neural prosthetic systems and their decode
algorithms must interact in closed-loop with a human user.  Decode algorithms 
are typically
studied offline with previously-gathered neural activity,
and there has been little closed-loop testing of
algorithms. Here we propose an online human prosthetic
simulator (OHPS) that allows subjects, interacting with a prosthesis driven
by synthetic neural activity, to inform the design of prostheses and decode algorithms.

As a first demonstration of the utility of the OHPS, we optimized the integration
bin width of the Kalman Filter, a key parameter
previously discussed in literature.  Five human
subjects made reaches to eight targets in a 3D 
environment (experiments approved by Stanford
University IRB). Synthetic neural activity was generated from
recorded kinematics via Poisson spiking with velocity-tuned rate.  Preferred 
directions and
average rates were randomly chosen with statistics to produce decode
quality quite similar to our non-human
primate experiments. Standard reaching trials were used to generate synthetic neural activity
for offline analysis. In online mode, subjects used
feedback and other behavioral strategies to
drive a closed-loop prosthetic reach.  Decoded kinematics within
each randomized block were generated
by a Kalman filter integrating neural activity at bin widths selected from
{50,100,150,200,250,300}ms.  

We analyzed online data with several performance metrics, all of which
indicated optimal performance at bin widths of 100-200ms (p<0.05 vs.
50,250,300ms).  We tested failure 
rate (target not acquired and held) and
time to reach the target.
Both show statistically significant performance improvements
for bin widths 100-150ms (failure rate also shows reduction for
200ms).  We also tested
integrated distance to target (which allows comparison to offline
data).  Again, we find an 
optimum of 100-150ms (p<0.05 vs. shorter and longer bin widths).  This
first result indicates that the OHPS can be used to meaningfully sweep
parameter settings in an online prosthesis.

The second result shows that online
analysis suggests different parameter optima
than offline analysis.  Using standard reaching trials, we decode
offline data across the same bin
widths.  We estimate
offline and online optima (bootstrap, minimum of a quadratic fit). For
OHPS trials, we find an optimum of 156ms (s.d. of 
4ms).  Offline, this
optimum is at 209ms (s.d. of 1ms), which better matches
previous offline studies in primates (Wu et al (2006) Neural
Comp).  These data demonstrate that there is a highly
significant difference between optimizations done in offline
and online analyses. 

The OHPS appears to be a powerful paradigm for optimizing algorithms
and algorithmic parameters, beyond standard offline
analyses.  Here we demonstrated that by optimizing the bin
width of a Kalman filter.  While experimenters could guess or spend considerable
time and resources sweeping parameters in a primate
experiment, we suggest the OHPS can be used to
narrow that search space.  Once more correspondence is
established between the OHPS and real neural prostheses (as
we plan to do with our non-human primate experiments; see
Gilja et al (2010) COSYNE), the OHPS may be used to directly set
optimal parameters and test algorithmic advances without further
online experiments. 
